# 15. Mix

## 新建项目

使用`mix new`命令即可新建一个新的项目

```
$ mix new example
```

运行之后`mix`会帮我们创建出目录和模板文件

```
* creating README.md
* creating .gitignore
* creating .formatter.exs
* creating mix.exs
* creating lib
* creating lib/example.ex
* creating test
* creating test/test_helper.exs
* creating test/example_test.exs
```

## 项目配置 mix.exs

该文件可以配置项目的环境、依赖等等

```
defmodule Example.Mixfile do
  use Mix.Project

  def project do
    [
      app: :example,
      version: "0.1.0",
      elixir: "~> 1.5",
      start_permanent: Mix.env() == :prod,
      deps: deps()
    ]
  end

  def application do
    [
      extra_applications: [:logger]
    ]
  end

  defp deps do
    []
  end
end

```

### project

定义项目的名称、版本、elixir版本号、依赖等等

### deps

定义项目依赖

```
def deps do
  [
    {:phoenix, "~> 1.1 or ~> 1.2"},
    {:phoenix_html, "~> 2.3"},
    {:cowboy, "~> 1.0", only: [:dev, :test]},
    {:slime, "~> 0.14"}
  ]
end
```

定义好依赖，还有最后一个步骤：获取依赖。这和`bundle install`的效果一样：

```
$ mix deps.get
```

### 环境管理

`mix`开箱即用三种环境

- `:dev`   默认的环境

- `:test`  测试环境，使用 `mix test` 后面会讲到

- `:prod`  生产环境，把应用上线到生产环境下的配置项

也可以从`Mix.env`变量中获取当前的环境，而且环境也可以通过`MIX_ENV`环境变量来配置

```
$ MIX_ENV = prod mix compile
```

## 编译

只要在项目的根目录运行 `mix compile` 命令，就能编译我们的项目

```
$ mix compile
```

## 交互

编译了项目之后，我们用下面的命令打开一个新的 iex 会话：

```
$ cd example
$ iex -S mix
```

