# 1. 安装

## 安装

> 参考
> - https://hexdocs.pm/ecto/getting-started.html
> - https://www.postgresql.org/

mix.exs配置deps

```
defp deps do
  [
    {:ecto_sql, "~> 3.4.0"},
    {:postgrex, ">= 0.0.0"}
  ]
end
```

执行 `mix deps.get`

> 如果下载依赖失败，可以参考`16.Mix.md`手动下载依赖

## 配置

生成连接数据库配置

```
mix ecto.gen.repo -r Friends.Repo
```

该命令会生成连接数据库的配置。

- `config/config.exs`

```
config :friends, Friends.Repo,
  database: "friends_repo",
  username: "user",
  password: "pass",
  hostname: "localhost"
```

> `username`和`password`需改为postgreSQL的用户名和密码。端口默认`5432`，如果不是需要指定端口号

- `lib/friends/repo.ex`

`Friends.Repo`模块由`mix ecto.gen.repo`命令定义

```
defmodule Friends.Repo do
  use Ecto.Repo,
    otp_app: :friends,
    adapter: Ecto.Adapters.Postgres
end
```

- `lib/friends/application.ex`

在`start/2`函数中将`Friends.Repo`设置为一个`supervision tree`中的`supervisor`

```
def start(_type, _args) do
  children = [
    Friends.Repo,
  ]

  ...
```

最后在`config/config.exs`的末尾添加一行：

```
config :friends, ecto_repos: [Friends.Repo]
```